<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>T·∫°o Valentine C√° Nh√¢n H√≥a</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Arial', sans-serif;
    }

    body {
      background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      color: #333;
    }

    .container {
      max-width: 800px;
      width: 100%;
      background: white;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      margin-bottom: 30px;
    }

    header {
      background: #ff4d6d;
      color: white;
      text-align: center;
      padding: 20px;
    }

    h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
    }

    .subtitle {
      font-size: 1.2rem;
      opacity: 0.9;
    }

    .content {
      padding: 30px;
    }

    .form-section {
      margin-bottom: 30px;
    }

    h2 {
      color: #ff4d6d;
      margin-bottom: 15px;
      font-size: 1.5rem;
    }

    .input-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 8px;
      font-weight: bold;
      color: #555;
    }

    input, textarea {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #e0e0e0;
      border-radius: 10px;
      font-size: 1rem;
      transition: border-color 0.3s;
    }

    input:focus, textarea:focus {
      border-color: #ff4d6d;
      outline: none;
    }

    textarea {
      min-height: 120px;
      resize: vertical;
    }

    .btn {
      background: #ff4d6d;
      color: white;
      border: none;
      padding: 14px 30px;
      border-radius: 50px;
      font-size: 1.1rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
      display: block;
      margin: 0 auto;
      box-shadow: 0 4px 15px rgba(255, 77, 109, 0.3);
    }

    .btn:hover {
      background: #ff3355;
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255, 77, 109, 0.4);
    }

    .preview-section {
      background: #f9f9f9;
      padding: 25px;
      border-radius: 15px;
      margin-top: 30px;
      text-align: center;
    }

    .preview-title {
      color: #ff4d6d;
      margin-bottom: 15px;
    }

    .preview-content {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
      margin-bottom: 20px;
    }

    .preview-image {
      max-width: 100%;
      border-radius: 10px;
      margin-bottom: 15px;
    }

    .hidden {
      display: none;
    }

    .share-section {
      text-align: center;
      margin-top: 20px;
      padding: 20px;
      background: #f0f8ff;
      border-radius: 15px;
    }

    .share-link {
      background: white;
      padding: 15px;
      border-radius: 10px;
      margin: 15px 0;
      word-break: break-all;
      font-family: monospace;
      border: 2px dashed #ff4d6d;
    }

    .copy-btn {
      background: #4CAF50;
      margin-top: 10px;
    }

    .copy-btn:hover {
      background: #45a049;
    }

    .hosting-info {
      margin-top: 30px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 15px;
      border-left: 5px solid #ff4d6d;
    }

    .hosting-info h3 {
      color: #ff4d6d;
      margin-bottom: 15px;
      font-size: 1.2rem;
    }

    .hosting-options {
      display: grid;
      gap: 15px;
      margin-bottom: 15px;
    }

    .option {
      background: white;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    .option strong {
      color: #ff4d6d;
      display: block;
      margin-bottom: 8px;
    }

    .option p {
      margin: 0;
      line-height: 1.5;
      color: #555;
    }

    .note {
      background: #fff3cd;
      border: 1px solid #ffeaa7;
      padding: 12px;
      border-radius: 8px;
      margin: 0;
      color: #856404;
      font-size: 0.9rem;
    }

    .valentine-display {
      text-align: center;
      padding: 30px;
    }

    .valentine-name {
      font-size: 2.5rem;
      color: #ff4d6d;
      margin: 20px 0;
    }

    .valentine-message {
      font-size: 1.2rem;
      line-height: 1.6;
      margin: 20px 0;
      padding: 20px;
      background: #fff9f9;
      border-radius: 15px;
      border-left: 5px solid #ff4d6d;
    }

    .gallery {
      --d: 10s;
      display: grid;
      place-items: center;
      width: 220px;
      margin: 30px auto;
    }

    .gallery > img {
      grid-area: 1/1;
      width: 100%;
      aspect-ratio: 1;
      object-fit: cover;
      border: 10px solid #f2f2f2;
      box-shadow: 0 0 4px #0007;
      z-index: 2;
      animation: slide var(--d) infinite, z-order var(--d) infinite steps(1);
    }

    .gallery img:last-child {
      animation-name: slide, z-order-last;
    }

    .gallery > img:nth-child(1) { animation-delay: calc(0*var(--d)); --r: 16deg; }
    .gallery > img:nth-child(2) { animation-delay: calc(-0.2*var(--d)); --r: -1deg; }
    .gallery > img:nth-child(3) { animation-delay: calc(-0.4*var(--d)); --r: -19deg; }
    .gallery > img:nth-child(4) { animation-delay: calc(-0.6*var(--d)); --r: 6deg; }
    .gallery > img:nth-child(5) { animation-delay: calc(-0.8*var(--d)); --r: -8deg; }

    @keyframes slide {
      10% { transform: translateX(120%) rotate(var(--r)); }
      0%, 100%, 20% { transform: translateX(0%) rotate(var(--r)); }
    }

    @keyframes z-order {
      10%, 20% { z-index: 1; }
      80% { z-index: 2; }
    }

    @keyframes z-order-last {
      10%, 20% { z-index: 1; }
      90% { z-index: 2; }
    }

    .back-btn {
      background: #6c757d;
      margin-top: 20px;
    }

    .back-btn:hover {
      background: #5a6268;
    }

    .image-preview {
      margin-top: 15px;
      text-align: center;
      padding: 15px;
      background: #f9f9f9;
      border-radius: 10px;
      border: 2px dashed #ff4d6d;
    }

    .image-preview img {
      max-width: 120px;
      max-height: 120px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      margin: 5px;
      object-fit: cover;
    }

    #preview-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-bottom: 15px;
    }

    .preview-item {
      position: relative;
      display: inline-block;
    }

    .preview-item .remove-single {
      position: absolute;
      top: -5px;
      right: -5px;
      background: #dc3545;
      color: white;
      border: none;
      border-radius: 50%;
      width: 25px;
      height: 25px;
      font-size: 12px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .remove-btn {
      background: #dc3545;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 20px;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.3s;
    }

    .remove-btn:hover {
      background: #c82333;
      transform: translateY(-1px);
    }

    input[type="file"] {
      padding: 8px;
      border: 2px dashed #ff4d6d;
      border-radius: 10px;
      background: #fff9f9;
      cursor: pointer;
      transition: all 0.3s;
    }

    input[type="file"]:hover {
      background: #fff0f0;
      border-color: #ff3355;
    }

    footer {
      text-align: center;
      margin-top: 20px;
      color: #666;
      font-size: 0.9rem;
    }

    @media only screen and (max-width: 600px) {
      h1 {
        font-size: 1.8rem;
      }
      
      .content {
        padding: 20px;
      }
      
      .gallery {
        width: 150px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üíñ Valentine C√° Nh√¢n H√≥a üíñ</h1>
      <p class="subtitle">T·∫°o trang Valentine ƒë·∫∑c bi·ªát d√†nh cho ng∆∞·ªùi ·∫•y</p>
    </header>
    
    <div class="content">
      <!-- Form t·∫°o Valentine -->
      <div id="creation-section">
        <div class="form-section">
          <h2>Th√¥ng tin c·ªßa b·∫°n</h2>
          <div class="input-group">
            <label for="user-name">T√™n c·ªßa b·∫°n</label>
            <input type="text" id="user-name" placeholder="Nh·∫≠p t√™n c·ªßa b·∫°n">
          </div>
          
          <div class="input-group">
            <label for="recipient-name">T√™n ng∆∞·ªùi nh·∫≠n</label>
            <input type="text" id="recipient-name" placeholder="Nh·∫≠p t√™n ng∆∞·ªùi b·∫°n y√™u th∆∞∆°ng">
          </div>
        </div>
        
        <div class="form-section">
          <h2>L·ªùi nh·∫Øn y√™u th∆∞∆°ng</h2>
          <div class="input-group">
            <label for="valentine-message">L·ªùi ch√∫c Valentine</label>
            <textarea id="valentine-message" placeholder="Vi·∫øt l·ªùi ch√∫c t·ª´ tr√°i tim c·ªßa b·∫°n..."></textarea>
          </div>
        </div>
        
        <div class="form-section">
          <h2>H√¨nh ·∫£nh ƒë·∫∑c bi·ªát</h2>
          <div class="input-group">
            <label for="image-upload">T·∫£i ·∫£nh t·ª´ m√°y t√≠nh (c√≥ th·ªÉ ch·ªçn nhi·ªÅu ·∫£nh)</label>
            <input type="file" id="image-upload" accept="image/*" multiple style="margin-bottom: 10px;">
            <div id="image-preview" class="image-preview hidden">
              <div id="preview-container"></div>
              <button type="button" id="remove-all-images" class="remove-btn">‚úï X√≥a t·∫•t c·∫£ ·∫£nh</button>
            </div>
            <small>Ho·∫∑c nh·∫≠p URL ·∫£nh (m·ªói d√≤ng m·ªôt URL):</small>
            <textarea id="image-urls" placeholder="https://example.com/image1.jpg&#10;https://example.com/image2.jpg&#10;https://example.com/image3.jpg" style="margin-top: 5px; min-height: 80px;"></textarea>
          </div>
        </div>
        
        <button id="create-btn" class="btn">T·∫°o Valentine C·ªßa T√¥i</button>
        
        <div class="preview-section">
          <h3 class="preview-title">Xem tr∆∞·ªõc</h3>
          <div class="preview-content">
            <p id="preview-text">Sau khi nh·∫≠p th√¥ng tin, b·∫°n s·∫Ω th·∫•y xem tr∆∞·ªõc t·∫°i ƒë√¢y</p>
          </div>
        </div>
      </div>
      
      <!-- Ph·∫ßn chia s·∫ª link -->
      <div id="share-section" class="hidden">
        <div class="share-section">
          <h2>Valentine c·ªßa b·∫°n ƒë√£ s·∫µn s√†ng!</h2>
          <p>Chia s·∫ª link n√†y v·ªõi ng∆∞·ªùi ·∫•y:</p>
          <div class="share-link" id="share-link">Link s·∫Ω xu·∫•t hi·ªán ·ªü ƒë√¢y</div>
          <button id="copy-btn" class="btn copy-btn">Sao ch√©p Link</button>
          
          <div class="hosting-info">
            <h3>üì§ C√°ch chia s·∫ª link cho ng∆∞·ªùi kh√°c:</h3>
            <div class="hosting-options">
              <div class="option">
                <strong>1. GitHub Pages (Mi·ªÖn ph√≠)</strong>
                <p>‚Ä¢ T·∫°o t√†i kho·∫£n GitHub.com<br>
                ‚Ä¢ T·∫°o repository m·ªõi<br>
                ‚Ä¢ Upload file index.html<br>
                ‚Ä¢ B·∫≠t GitHub Pages trong Settings</p>
              </div>
              <div class="option">
                <strong>2. Netlify (D·ªÖ nh·∫•t)</strong>
                <p>‚Ä¢ Truy c·∫≠p netlify.com<br>
                ‚Ä¢ K√©o th·∫£ file index.html<br>
                ‚Ä¢ Nh·∫≠n link ngay l·∫≠p t·ª©c</p>
              </div>
              <div class="option">
                <strong>3. Vercel</strong>
                <p>‚Ä¢ Truy c·∫≠p vercel.com<br>
                ‚Ä¢ Upload file ho·∫∑c k·∫øt n·ªëi GitHub<br>
                ‚Ä¢ Deploy t·ª± ƒë·ªông</p>
              </div>
            </div>
            <p class="note">üí° <strong>L∆∞u √Ω:</strong> Link hi·ªán t·∫°i ch·ªâ ho·∫°t ƒë·ªông tr√™n m√°y b·∫°n. C·∫ßn upload l√™n web server ƒë·ªÉ chia s·∫ª!</p>
          </div>
          
          <button id="new-valentine" class="btn back-btn">T·∫°o Valentine M·ªõi</button>
        </div>
      </div>
      
      <!-- Ph·∫ßn hi·ªÉn th·ªã Valentine -->
      <div id="valentine-display" class="valentine-display hidden">
        <h1 id="display-title">Happy Valentine's Day! üíû</h1>
        <div class="valentine-name" id="display-recipient"></div>
        
        <div class="gallery" id="valentine-gallery">
          <!-- ·∫¢nh s·∫Ω ƒë∆∞·ª£c th√™m ƒë·ªông t·ª´ d·ªØ li·ªáu ng∆∞·ªùi d√πng -->
        </div>
        
        <div class="valentine-message" id="display-message"></div>
        <p id="display-sender" style="font-style: italic; margin-top: 20px;"></p>
        
        <button id="back-to-creation" class="btn back-btn">T·∫°o Valentine M·ªõi</button>
      </div>
    </div>
  </div>
  
  <footer>
    <p>Made with ‚ù§Ô∏è | Chia s·∫ª t√¨nh y√™u c·ªßa b·∫°n ƒë·∫øn m·ªçi ng∆∞·ªùi</p>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const creationSection = document.getElementById('creation-section');
      const shareSection = document.getElementById('share-section');
      const valentineDisplay = document.getElementById('valentine-display');
      const createBtn = document.getElementById('create-btn');
      const copyBtn = document.getElementById('copy-btn');
      const newValentineBtn = document.getElementById('new-valentine');
      const backToCreationBtn = document.getElementById('back-to-creation');
      const shareLink = document.getElementById('share-link');
      
      const userNameInput = document.getElementById('user-name');
      const recipientNameInput = document.getElementById('recipient-name');
      const messageInput = document.getElementById('valentine-message');
      const imageUrlsInput = document.getElementById('image-urls');
      const imageUploadInput = document.getElementById('image-upload');
      const imagePreview = document.getElementById('image-preview');
      const previewContainer = document.getElementById('preview-container');
      const removeAllImagesBtn = document.getElementById('remove-all-images');
      
      const displayRecipient = document.getElementById('display-recipient');
      const displayMessage = document.getElementById('display-message');
      const displaySender = document.getElementById('display-sender');
      const previewText = document.getElementById('preview-text');
      
      // Ki·ªÉm tra xem c√≥ tham s·ªë URL kh√¥ng (trang hi·ªÉn th·ªã Valentine)
      const urlParams = new URLSearchParams(window.location.search);
      const valentineData = urlParams.get('data');
      
      if (valentineData) {
        // Hi·ªÉn th·ªã trang Valentine
        showValentineDisplay(valentineData);
      }
      
      // C·∫≠p nh·∫≠t preview
      function updatePreview() {
        const userName = userNameInput.value || 'B·∫°n';
        const recipientName = recipientNameInput.value || 'Ng∆∞·ªùi ·∫•y';
        const message = messageInput.value || 'L·ªùi ch√∫c t·ª´ tr√°i tim...';
        
        previewText.innerHTML = `
          <strong>${userName}</strong> g·ª≠i ƒë·∫øn <strong>${recipientName}</strong>:<br><br>
          "${message.substring(0, 100)}${message.length > 100 ? '...' : ''}"
        `;
      }
      
      userNameInput.addEventListener('input', updatePreview);
      recipientNameInput.addEventListener('input', updatePreview);
      messageInput.addEventListener('input', updatePreview);

      // M·∫£ng l∆∞u tr·ªØ ·∫£nh ƒë√£ upload
      let uploadedImages = [];

      // X·ª≠ l√Ω upload nhi·ªÅu ·∫£nh
      imageUploadInput.addEventListener('change', function(e) {
        const files = Array.from(e.target.files);
        
        // Ki·ªÉm tra t·ª´ng file
        for (let file of files) {
          if (!file.type.startsWith('image/')) {
            alert(`File "${file.name}" kh√¥ng ph·∫£i l√† ·∫£nh h·ª£p l·ªá!`);
            continue;
          }
          
          if (file.size > 5 * 1024 * 1024) {
            alert(`·∫¢nh "${file.name}" qu√° l·ªõn (t·ªëi ƒëa 5MB)!`);
            continue;
          }
          
          // ƒê·ªçc v√† th√™m ·∫£nh v√†o m·∫£ng
          const reader = new FileReader();
          reader.onload = function(e) {
            uploadedImages.push({
              name: file.name,
              data: e.target.result
            });
            updateImagePreview();
          };
          reader.readAsDataURL(file);
        }
        
        // X√≥a URL input khi c√≥ file upload
        if (files.length > 0) {
          imageUrlsInput.value = '';
        }
      });

      // C·∫≠p nh·∫≠t preview ·∫£nh
      function updateImagePreview() {
        previewContainer.innerHTML = '';
        
        uploadedImages.forEach((image, index) => {
          const previewItem = document.createElement('div');
          previewItem.className = 'preview-item';
          previewItem.innerHTML = `
            <img src="${image.data}" alt="${image.name}">
            <button type="button" class="remove-single" onclick="removeImage(${index})">‚úï</button>
          `;
          previewContainer.appendChild(previewItem);
        });
        
        if (uploadedImages.length > 0) {
          imagePreview.classList.remove('hidden');
        } else {
          imagePreview.classList.add('hidden');
        }
      }

      // X√≥a ·∫£nh ƒë∆°n l·∫ª
      window.removeImage = function(index) {
        uploadedImages.splice(index, 1);
        updateImagePreview();
      };

      // X√≥a t·∫•t c·∫£ ·∫£nh
      removeAllImagesBtn.addEventListener('click', function() {
        imageUploadInput.value = '';
        uploadedImages = [];
        updateImagePreview();
      });

      // Khi nh·∫≠p URL, x√≥a file upload
      imageUrlsInput.addEventListener('input', function() {
        if (this.value.trim()) {
          imageUploadInput.value = '';
          uploadedImages = [];
          updateImagePreview();
        }
      });
      
      // T·∫°o Valentine
      createBtn.addEventListener('click', function() {
        const userName = userNameInput.value.trim();
        const recipientName = recipientNameInput.value.trim();
        const message = messageInput.value.trim();
        const imageUrls = imageUrlsInput.value.trim();
        
        if (!userName || !recipientName || !message) {
          alert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin!');
          return;
        }
        
        // Thu th·∫≠p t·∫•t c·∫£ ·∫£nh
        let allImages = [];
        
        // Th√™m ·∫£nh ƒë√£ upload
        if (uploadedImages.length > 0) {
          allImages = uploadedImages.map(img => img.data);
        }
        
        // Th√™m ·∫£nh t·ª´ URL
        if (imageUrls) {
          const urls = imageUrls.split('\n').filter(url => url.trim());
          allImages = allImages.concat(urls);
        }
        
        // T·∫°o Valentine v·ªõi t·∫•t c·∫£ ·∫£nh
        createValentineWithImages(userName, recipientName, message, allImages);
      });

      // Function t·∫°o Valentine v·ªõi nhi·ªÅu ·∫£nh
      function createValentineWithImages(userName, recipientName, message, images) {
        // T·∫°o d·ªØ li·ªáu Valentine
        const valentineData = {
          u: userName,
          r: recipientName,
          m: message,
          images: images
        };
        
        // M√£ h√≥a d·ªØ li·ªáu th√†nh chu·ªói base64
        const encodedData = btoa(JSON.stringify(valentineData));
        
        // T·∫°o link chia s·∫ª
        const shareUrl = `${window.location.origin}${window.location.pathname}?data=${encodedData}`;
        
        // Hi·ªÉn th·ªã ph·∫ßn chia s·∫ª
        creationSection.classList.add('hidden');
        shareSection.classList.remove('hidden');
        shareLink.textContent = shareUrl;
      }
      
      // Sao ch√©p link
      copyBtn.addEventListener('click', function() {
        navigator.clipboard.writeText(shareLink.textContent)
          .then(() => {
            alert('ƒê√£ sao ch√©p link v√†o clipboard!');
          })
          .catch(err => {
            console.error('L·ªói khi sao ch√©p: ', err);
          });
      });
      
      // T·∫°o Valentine m·ªõi
      newValentineBtn.addEventListener('click', function() {
        shareSection.classList.add('hidden');
        creationSection.classList.remove('hidden');
        
        // Reset form
        userNameInput.value = '';
        recipientNameInput.value = '';
        messageInput.value = '';
        imageUrlsInput.value = '';
        imageUploadInput.value = '';
        uploadedImages = [];
        updateImagePreview();
        updatePreview();
      });
      
      // Quay l·∫°i t·∫°o Valentine m·ªõi
      backToCreationBtn.addEventListener('click', function() {
        valentineDisplay.classList.add('hidden');
        creationSection.classList.remove('hidden');
        
        // Reset form
        userNameInput.value = '';
        recipientNameInput.value = '';
        messageInput.value = '';
        imageUrlsInput.value = '';
        imageUploadInput.value = '';
        uploadedImages = [];
        updateImagePreview();
        updatePreview();
      });
      
      // Hi·ªÉn th·ªã trang Valentine
      function showValentineDisplay(encodedData) {
        try {
          // Gi·∫£i m√£ d·ªØ li·ªáu
          const valentineData = JSON.parse(atob(encodedData));
          
          // Hi·ªÉn th·ªã th√¥ng tin
          displayRecipient.textContent = valentineData.r;
          displayMessage.textContent = valentineData.m;
          displaySender.textContent = `From: ${valentineData.u} ‚ù§Ô∏è`;
          
          // ·∫®n ph·∫ßn t·∫°o v√† hi·ªÉn th·ªã ph·∫ßn Valentine
          creationSection.classList.add('hidden');
          shareSection.classList.add('hidden');
          valentineDisplay.classList.remove('hidden');
          
          // Hi·ªÉn th·ªã ·∫£nh trong gallery
          const gallery = document.getElementById('valentine-gallery');
          gallery.innerHTML = '';
          
          // L·∫•y danh s√°ch ·∫£nh (h·ªó tr·ª£ c·∫£ format c≈© v√† m·ªõi)
          let images = [];
          if (valentineData.images && Array.isArray(valentineData.images)) {
            images = valentineData.images;
          } else if (valentineData.i) {
            images = [valentineData.i];
          }
          
          // Th√™m t·ª´ng ·∫£nh v√†o gallery
          images.forEach((imageSrc, index) => {
            const img = document.createElement('img');
            img.src = imageSrc;
            img.alt = `·∫¢nh ${index + 1}`;
            gallery.appendChild(img);
          });
          
          // Th√™m CSS animation cho c√°c ·∫£nh
          if (images.length > 0) {
            const style = document.createElement('style');
            let cssText = '';
            images.forEach((_, index) => {
              cssText += `
                .gallery > img:nth-child(${index + 1}) {
                  animation-delay: calc(-${index * 0.2}*var(--d));
                  --r: ${(index % 2 === 0 ? -1 : 1) * (5 + index * 3)}deg;
                }
              `;
            });
            style.textContent = cssText;
            document.head.appendChild(style);
          }
        } catch (error) {
          console.error('L·ªói khi gi·∫£i m√£ d·ªØ li·ªáu:', error);
          alert('Link Valentine kh√¥ng h·ª£p l·ªá!');
        }
      }
    });
  </script>
</body>
</html>
